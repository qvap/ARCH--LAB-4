# Network Packet Sniffer

Этот проект представляет собой сетевой сниффер пакетов, написанный на C#, который захватывает и анализирует IP пакеты в реальном времени.

## Функциональность

### IP Packet Parsing
- Версия IP протокола
- Длина заголовка IP
- Тип службы (Type of Service)
- Общая длина пакета
- Идентификатор
- Флаги (DF, MF, Reserved)
- Смещение фрагмента
- Время жизни (TTL)
- Протокол
- Контрольная сумма заголовка
- IP-адреса источника и назначения
- Размер данных

### TCP Packet Parsing
- Порты источника и назначения
- Номер последовательности
- Номер подтверждения
- Длина заголовка TCP
- Флаги TCP (FIN, SYN, RST, PSH, ACK, URG, ECE, CWR)
- Размер окна
- Контрольная сумма
- Указатель срочности
- Размер данных TCP

### UDP Packet Parsing
- Порты источника и назначения
- Длина UDP пакета
- Контрольная сумма
- Размер данных UDP

### DNS Packet Parsing (для UDP пакетов на порту 53)
- ID транзакции
- Тип (запрос/ответ)
- Опкод
- Флаги (авторитативный ответ, обрезанный, рекурсия)
- Код ответа
- Количество записей (вопросы, ответы, серверы имен, дополнительные)
- Парсинг DNS вопросов с типами записей (A, NS, CNAME, MX, AAAA)

## Использование

1. Запустите программу от имени администратора (требуется для создания raw socket)
2. Введите локальный IP-адрес для прослушивания
3. Программа начнет захватывать и отображать информацию о проходящих пакетах
4. Нажмите Enter для выхода

## Требования

- Windows (использует специфичные для Windows API)
- .NET 9.0 или выше
- Права администратора для создания raw socket

## Архитектура

### Классы:

- `Program` - основной класс с точкой входа
- `Sniffer` - класс для создания и управления raw socket
- `IPHeader` - парсинг IP заголовков
- `TCPHeader` - парсинг TCP заголовков  
- `UDPHeader` - парсинг UDP заголовков
- `DNSHeader` - парсинг DNS заголовков

### Особенности реализации:

- Асинхронная обработка пакетов
- Обработка сетевого порядка байтов (Network to Host Order)
- Детальный парсинг протоколов с выводом всей доступной информации
- Обработка ошибок для каждого типа протокола
- Поддержка DNS парсинга для UDP трафика

## Предупреждения

- Программа требует права администратора
- Работает только на Windows
- Raw socket может захватывать конфиденциальную информацию
- Используйте только в образовательных целях или для отладки собственной сети
